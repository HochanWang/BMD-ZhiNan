%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright © 2023 Haochen WANG (王昊辰).
% Contact: whch.o@outlook.com： +86 18921173379； +31 0633217019； +44 07579859390
%YinRen-YuShu 3401, WuXi, JiangSu, PRC; 214011 （中华人民共和国，江苏，无锡，银仁-御墅，3401； 214011）
%
% This LaTeX template has been developed and produced by Haochen WANG (王昊辰).
% Excluding the written content, this template is distributed under a Creative Commons Attribution-NonCommercial 4.0 International License (CC BY-NC 4.0).
% Please adhere to the terms of this license when utilising this template.
% Comprehensive information about the license can be found at:
%https://creativecommons.org/licenses/by-nc/4.0/
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{book}
\usepackage[twoside=true,inner=19mm,outer=12.7mm,top=20mm,bottom=20mm,paperwidth=6in,paperheight=9in]{geometry} %页边距
\usepackage{emptypage} 
\usepackage[UTF8]{ctex} % 支持中文
\usepackage{fontspec} % 使用fontspec宏包
%\setmainfont{CMU Serif} % 设置英文字体CMU
\setmainfont{Liberation Serif} % 自由衬线
\setCJKmainfont{SourceHanSerifSC-Medium.otf} % 设置中文正文字体为思源宋体
\newCJKfontfamily\sectionfont{SourceHanSerifSC-Heavy.otf}

%设置目录自号
\usepackage{tocloft}
\renewcommand{\cftsecfont}{\fontsize{10.5pt}{17pt}\selectfont}  % 设定 section 标题的字号
\renewcommand{\cftsubsecfont}{\fontsize{10.5pt}{17pt}\selectfont} % 设定 subsection 标题的字号
\renewcommand{\cftsubsubsecfont}{\fontsize{10.5pt}{17pt}\selectfont} % 设定 subsection 标题的字号
\renewcommand{\cftparafont}{\fontsize{10.5pt}{17pt}\selectfont}  % 设定 paragraph 标题的字号
\renewcommand{\cftsubparafont}{\fontsize{10.5pt}{17pt}\selectfont} % 设定 subparagraph 标题的字号

\usepackage{lipsum} % 用于生成随机文字
\usepackage{ccicons} % 创作共享图标
\usepackage{hyperref} % 提供超链接功能
\hypersetup{
    colorlinks=false, %取消超链接的颜色
    pdfborder={0 0 1}, %显示超链接的下划线
    urlbordercolor={0 0 1} %设定超链接方框颜色
}
\usepackage{fancyhdr} % 添加fancyhdr宏包
\usepackage[ddmmyyyy]{datetime}%日期
\usepackage{indentfirst} % 用于段首缩进
\usepackage{ragged2e} % 用于对齐
\usepackage{tabularx} % 用于表格
\usepackage{indentfirst} % 添加indentfirst宏包，使所有的段落都在开始时自动缩进
\usepackage{titlesec} %用于设置标题
\usepackage{ulem} %下划线
\usepackage{pgfplots}%用于蜘蛛图
\pgfplotsset{compat=1.15} %用于蜘蛛图
\usepgfplotslibrary{polar}%用于蜘蛛图
\usepackage{wrapfig}%用于蜘蛛图
\usepackage{pdfpages}%pdf page
\usepackage{xcolor}%字体颜色
\definecolor{light-gray}{gray}{0.8}%定义颜色light-gray
\definecolor{dark-gray}{gray}{0.5}%定义颜色dark-gray
\usepackage{zhnumber} % 导入将数字转换为中文数字的宏包
%\renewcommand\thesection{\zhdigits*{\arabic{section}}} 
% 重定义section编号的显示方式，将阿拉伯数字转换为中文的大写数字，“壹、贰、叁”形式。
\setcounter{secnumdepth}{5} % 使得五级标题都有编号
\setcounter{tocdepth}{5} % 使得五级标题都能在目录中显示
\usepackage{pgfgantt} %gantt chart

%设置chapter样式
\titleformat{\chapter}[block] % "block"样式以匹配其他标题样式
{\normalfont\fontsize{35}{30}\bfseries\sectionfont} %标题字号，字体
{} %去掉编号
{0pt} %标题和标题名之间的空格
{\thispagestyle{fancy}} % 在每个章节的开始使用 fancy 页脚样式
\setcounter{chapter}{-1}%目录从0开始算

%\titlespacing*{\chapter}{0pt}{0pt}{20pt} %调整空白空间


%设置section样式
\titleformat{\section}
{\normalfont\fontsize{14}{27}\bfseries\sectionfont} %子标题字号，字体
{\thesection}
{1em}
{}

%设置subsection样式
\titleformat{\subsection}
{\normalfont\fontsize{11}{25}\bfseries\sectionfont} %子标题字号，字体
{\thesubsection}
{1em}
{}

%设置subsubsection样式
\titleformat{\subsubsection}
{\normalfont\fontsize{10.5}{25}\bfseries\sectionfont} %子标题字号，字体
{\thesubsubsection}
{1em}
{}

\pagestyle{fancy} % 设置页面样式为fancy
\fancyhead{} % 清空页眉设置
\fancyfoot{} % 清空页脚设置
\fancyhead[LE,RO]{\textbf{\fontsize{10.5}{17}\sectionfont\textcolor{dark-gray}\rightmark}} %右上角打上subsection
\renewcommand{\headrulewidth}{0pt} % 去除页眉横线
\fancyfoot[LE,RO]{\fontsize{11}{17}\textbf{\thepage}} %页码
\fancyfoot[RE,LO]{\textcolor{light-gray}{Copyright © 2023 by Haochen WANG （王昊辰）}}

\setlength\parindent{2em} %首行缩进

\newlength{\betsubsec}
\setlength{\betsubsec}{0.01\textheight}  % 定义subsection间的空白




% 修改目录
\renewcommand{\contentsname}{\fontsize{35}{30}\bfseries\sectionfont{目录}} 

\newenvironment{toc}{
  \pagestyle{empty} % 在环境开始时设置页面样式为空
  \tableofcontents
  \clearpage
}{%
  \pagestyle{fancy} % 在环境结束时重新设置页面样式
}

\cftsetindents{chapter}{0em}{1em} %改缩进
\cftsetindents{section}{1em}{2em}
\cftsetindents{subsection}{2em}{2.8em}
\cftsetindents{subsubsection}{3em}{3.1em}
\cftsetindents{paragraph}{4em}{3.4em}

%改enurmate样式
\usepackage{enumitem} % 导入enumitem宏包
\setlist[enumerate]{itemsep=0pt} % 设置所有的enumerate环境中项目之间的间距

%正式开始文档
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\includepdf[pages=1,fitpaper=true]{cover.pdf} %封面

\begin{titlepage} % 开始创建扉页
\newgeometry{vmargin={20mm}, hmargin={19mm,12.7mm}}  % 设置自定义边距

\vspace*{\stretch{0.382}} % 使用黄金分割比例来分配空间

% 标题部分
\begin{flushright} % 使用 flushright 环境来实现右对齐
\fontsize{40}{10}\bfseries\sectionfont{ME指南} % \fontsize 设置特大号字体，\textbf 使文字加粗
\end{flushright}

\vspace*{\stretch{0.236}} % 使用黄金分割比例来分配空间

% 作者部分
\begin{flushright} % 使用 flushright 环境来实现右对齐
\fontsize{24}{0}\selectfont{王昊辰\textsuperscript{1}} % \fontsize 设置较大号字体，\textbf 使文字加粗
\end{flushright}

\vspace*{\stretch{0.05}} % 使用黄金分割比例来分配空间

% co-author部分
\begin{flushright} % 使用 flushright 环境来实现右对齐
\fontsize{16}{0}\selectfont{张先治\textsuperscript{2}、邓云洁\textsuperscript{3}、马润禹\textsuperscript{4}、刘彦菁\textsuperscript{5}\\祁晨晨\textsuperscript{6}、孙天辰\textsuperscript{7}、熊俊彦\textsuperscript{8}} % Co-author写上
\end{flushright}

\vspace*{\stretch{0.382}} % 使用黄金分割比例来分配空间

% 版权信息部分
\begin{flushright} 
\fontsize{7}{8}\selectfont\textcolor{dark-gray}{
{Address: YinRen-YuShu 3401, WuXi, JiangSu, P.R.C.; 214011}\\
{Contact: \href{mailto:whch.o@outlook.com}{whch.o@outlook.com}}\\
{Unless otherwise noted, contents within this brochure are licensed under the \ccbyncsa\ \href{http://creativecommons.org/licenses/by-nc-sa/4.0/}{\uline{CC BY-NC-SA 4.0}.}}\\
{Pre-release, updated as of \today}}
\end{flushright}

\vspace*{\stretch{0.618}} % 使用黄金分割比例来分配空间

\end{titlepage} % 结束创建标题页

\cleardoublepage
% 在生成目录前将页面样式设置为空
\pagestyle{empty}
\addtocontents{toc}{\protect\thispagestyle{empty}} % 在这里插入
\begin{toc} % 使用自定义环境生成目录
\end{toc}
% 设置此页样式为空

\thispagestyle{fancy} % Reset the style immediately after the table of contents
\pagestyle{fancy} % 在新的一章开始时再将页面样式重新设置为fancy
%\pagenumbering{arabic} % 重新开始页码计数，并应用页眉页脚样式
\addtocounter{page}{-6}
\fontsize{10.5}{16}\selectfont % 字体大小和行距

\cleardoublepage
\newpage\input{序}

\cleardoublepage
\newpage\input{上辑}

\cleardoublepage
\newpage\input{下辑}

\cleardoublepage
\newpage\input{跋}

\cleardoublepage
\newpage
\thispagestyle{empty}

\vspace*{\fill}
\begin{center}
    \Huge 完 %封底前一页
\end{center}
\vspace*{\fill}

\newpage
\includepdf[pages=2,fitpaper=true]{cover.pdf} %封底

\end{document}